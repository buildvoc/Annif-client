<!DOCTYPE html>
<html>
  <head>
    <title>Fire Safety Analytics</title>
    <link
      rel="favicon.ico"
      type="image/jpg"
      href="https://m.text-analytics.buildvoc.co.uk/favicon.ico"
    />
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <!-- <link
      rel="stylesheet"
      href="https://code.jquery.com/mobile/1.5.0-alpha.1/jquery.mobile-1.5.0-alpha.1.min.css"
    /> -->
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
    <script src="https://code.jquery.com/mobile/1.5.0-alpha.1/jquery.mobile-1.5.0-alpha.1.min.js"></script>
    <script src="https://code.responsivevoice.org/responsivevoice.js"></script>
    <script src="/compressor.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-A3rJD856KowSb7dwlZdYEkO39Gagi7vIsF0jrRAoQmDKKtQBHUuLZ9AsSv4jD4Xa" crossorigin="anonymous"></script>
    

    <style type="text/css">
      .enable-post-to-vocabseditor {
        width: 30px;
        height: 30px;
        z-index: 10000000;
        border-radius: 50%;
      }

      .enable-post-to-vocabseditor button{
        appearance: none;
        width: 100%;
        height: 100%;
        margin-top: 1rem;
        background-color: red;
        border-radius: 50%;
        border: none;
        cursor: pointer;
      }

      .ui-selectmenu-button-text {
        visibility: hidden;
      }

      #results {
        list-style: none;
        padding-left: 7px;
      }

      #results li a {
        padding-left: 7px;
      }

      meter { 
        width: 24px;
        border: none;
        border-radius: 0;
        height: 18px;
        background-color: #ccc;
        box-shadow: 0 12px 3px -5px #e6e6e6 inset;
      }

      meter::-webkit-meter-bar {
        border: none;
        border-radius: 0;
        height: 18px;
        background-color: #ccc;
        box-shadow: 0 12px 3px -5px #e6e6e6 inset;
      }

      meter::-webkit-meter-optimum-value, meter::-moz-meter-optimum {
        background: #f5d085;
      }

      meter::-webkit-meter-suboptimum-value, meter::-moz-sub-optimum {
        background: #b4c365;
      }

      meter::-webkit-meter-even-less-good-value, meter::-moz-meter-sub-sub-optimum {
        background: #5cb85c;
      }

      .elipsis {
        white-space: nowrap; 
        width: 32px; 
        overflow: hidden;
        text-overflow: ellipsis;
      }

      /* Loading screen */
      .ui-loading .ui-loader {
        display: block;
      }
      .ui-loader {
        display: none;
        z-index: 9999999;
        position: fixed;
        top: 50%;
        left: 50%;
        border-width: 0;
      }
      .ui-loader-default {
        background: none;
        filter: Alpha(Opacity=18);
        opacity: .18;
        width: 2.875em;
        height: 2.875em;
        margin-left: -1.4375em;
        margin-top: -1.4375em;
      }
      .ui-loader-verbose {
        width: 12.5em;
        filter: Alpha(Opacity=88);
        opacity: .88;
        box-shadow: 0 1px 1px -1px #fff;
        height: auto;
        margin-left: -6.875em;
        margin-top: -2.6875em;
        padding: .625em;
      }
      .ui-loader-default h1 {
        font-size: 0;
        width: 0;
        height: 0;
        overflow: hidden;
      }
      .ui-loader-verbose h1 {
        font-size: 1em;
        margin: 0;
        text-align: center;
      }
      .ui-loader .ui-icon-loading {
        background-color: #000;
        display: block;
        margin: 0;
        width: 2.75em;
        height: 2.75em;
        padding: .0625em;
        -webkit-border-radius: 2.25em;
        border-radius: 2.25em;
      }
      .ui-loader-verbose .ui-icon-loading {
        margin: 0 auto .625em;
        filter: Alpha(Opacity=75);
        opacity: .75;
      }
      .ui-loader-textonly {
        padding: .9375em;
        margin-left: -7.1875em;
      }
      .ui-loader-textonly .ui-icon-loading {
        display: none;
      }
      .ui-icon-loading {
          background: url(https://code.jquery.com/mobile/1.5.0-alpha.1/images/ajax-loader.gif);
          background-size: 2.875em 2.875em;
      }
    </style>
    
    <script>
      var presentationTextResults = [];
      var clickTimer;
      var OCR_BACKEND_URL = "cgi-bin/ocr.cgi";
      var ANNIF_BASE_URL = "https://text-analytics.buildvoc.co.uk/v1/";
      var enablePostToVocabseditor = false;

      // hardcoded projects for now
      // TODO read available projects from API instead
      var PROJECTS = {
        "nn-omikuji-ensemble-en": {
          name: "Neural Network,Omikuji & MLLM",
          language: "en",
        },
        "bldg-ensemble-omikuji-mllm-en": {
          name: "Omikuji & MLLM",
          language: "en",
        },
        "bldg-tfidf-en": {
          name: "Terms Frequency(TFIDF)",
          language: "en",
        },
      };

      // which voice setting to use for Responsive Voice synthesis, per language
      var VOICE_PER_LANGUAGE = {
        fi: "Finnish Female",
        sv: "Swedish Female",
        en: "UK English Female",
      };

      $(function () {
        const resizeObserver = new ResizeObserver((entries) => {
        const properHeight = Math.max(document.body.scrollHeight, document.body.offsetHeight, document.body.clientHeight)
          $('.overlay-container').height(properHeight);
        })
        $('body').click(function (e) {
          if(!$('.overlay-container').hasClass('active'))
            return;
          if(!$(e.target).closest('.information-box').length && !$(e.target).is('.infotmation-box')) {
            $(".info-icon").click();
          }     
        });
        resizeObserver.observe($('.information-box')[0]);

        $("#tabs").tabs({
          activate: function (event, ui) {
            responsiveVoice.cancel();
          },
        });

        $.each(PROJECTS, function (project_id, project_data) {
          $("#project").append(
            $("<option>").attr("value", project_id).append(project_data.name)
          );
        });
        $("#project").selectmenu("refresh");
        $(".copy-button").on("click", function () {
          var textToBeCopied = $("#previewtext").val() + "\n" + getTopicsText();
          copyToClipboard(textToBeCopied);
        });
        $(".upload-button").on("click", function (e) {
          $("#imagefile-upload").click();
        });
        $("#imagefile-upload").on("click", function (e) {
          e.stopPropagation();
        });
        $(".capture-presentation-button").on("click", function (e) {
          $("#imagefile-capture-multiple").click();
        });
        $("#imagefile-capture-multiple").on("click", function (e) {
          e.stopPropagation();
        });
        $("#imagefile-capture-multiple").on("change", function (e) {
          handleImagePresentation(this.files);
        });
        $(".topics-button").on("click", function (e) {
          if (presentationTextResults.length !== 0) {
            endPresentation();
          }
        });

        $('.info-icon').on('click', function(e){
          e.stopPropagation();
          $('.overlay-container').toggleClass('active');
        })
        $('.enable-post-to-vocabseditor button').on('click', function(e){
          if(enablePostToVocabseditor){
            e.target.style = `background-color: red;`;
            enablePostToVocabseditor = false;
          }
          else{
            e.target.style = `background-color: green;`;
            enablePostToVocabseditor = true;
          }
        });

      });

      function current_language() {
        var project = $("#project").val();
        return PROJECTS[project].language;
      }

      function handleImagePresentation(files) {
        new Compressor(files[0], {
          quality: 0.2,
          success(compressedImage) {
            $.mobile.loading("show");
            compressedImage = new File([compressedImage], compressedImage.name);
            console.log(compressedImage);
            var formData = new FormData();
            formData.append("imagefile", compressedImage);
            formData.append("language", current_language());
            jQuery.ajax({
              url: OCR_BACKEND_URL,
              data: formData,
              cache: false,
              contentType: false,
              processData: false,
              type: "POST",
              success: function (result) {
                presentationTextResults.push(result);
                var fullText = presentationTextResults.reduce(
                  (prevText, text) => prevText + '\n' + text,
                  ""
                );
                $("#previewtext").val(fullText);
                $("#previewtext").keyup();
                // $('a[href="#text"]').trigger("click");
                $('.text-tab').click(); //
                $.mobile.loading('hide');
              },
            });
            var img = document.getElementById("previewimg");
            var reader = new FileReader();
            reader.onload = (function (aImg) {
              return function (e) {
                aImg.src = e.target.result;
              };
            })(img);
            reader.readAsDataURL(compressedImage);
          }
        });
      }

      function handleImage(files) {
        new Compressor(files[0], {
          quality: 0.2,
          success(compressedImage){
            $.mobile.loading("show");
            compressedImage = new File([compressedImage], compressedImage.name);
            console.log(compressedImage);
            var formData = new FormData();
            formData.append("imagefile", compressedImage);
            formData.append("language", current_language());
            jQuery.ajax({
              url: OCR_BACKEND_URL,
              data: formData,
              cache: false,
              contentType: false,
              processData: false,
              type: "POST",
              success: function (result) {
                $("#previewtext").val(result);
                $("#previewtext").keyup();
                // $('a[href="#text"]').trigger("click");
                $('.text-tab').click(); //
                autoindex();
              },
            });
            var img = document.getElementById("previewimg");
            var reader = new FileReader();
            reader.onload = (function (aImg) {
              return function (e) {
                aImg.src = e.target.result;
              };
            })(img);
            reader.readAsDataURL(compressedImage);
          }
        });
      }

      function autoindex() {
        $.mobile.loading("show");
        let uris = [];
        let scores = [];
        $.ajax({
          url: ANNIF_BASE_URL + "projects/" + $("#project").val() + "/suggest",
          method: "POST",
          data: { text: $("#previewtext").val() },
          success: function (data) {
            $("#results").empty();
            var labels = [];
            $.each(data.results, function (idx, value) {
              uris.push(value.uri);
              scores.push(value.score.toFixed(2));
              $("#results").append(
                $("<li>").append(
                  $("<meter>").attr("low", "0.33").attr("high", "0.66").attr("optimum", "1.0").attr("value", value.score),
                  $("<a>").attr("href", value.uri).attr('target','_blank').append(value.label)
                )
              );
              labels.push(value.label);
            });
            $.mobile.loading("hide");
            // $('a[href="#topics"]').trigger("click");
            $('.topics-tab').click(); //
            var labellist = labels.join(". ");
            if(enablePostToVocabseditor)
              postToVocabseditor($("#previewtext").val(), uris, scores, current_language());
            responsiveVoice.speak(
              labellist,
              VOICE_PER_LANGUAGE[current_language()]
            );
            $.mobile.loading("hide");
          },
        });

      }

      function endPresentation() {
        var fullText = presentationTextResults.reduce(
          (prevText, text) => prevText + '\n' + text,
          ""
        );
        $.mobile.loading("show");
        let uris = [];
        let scores = [];
        $.ajax({
          url: ANNIF_BASE_URL + "projects/" + $("#project").val() + "/suggest",
          method: "POST",
          data: { text: fullText },
          success: function (data) {
            $("#results").empty();
            var labels = [];
            $.each(data.results, function (idx, value) {
              uris.push(value.uri);
              scores.push(value.score.toFixed(2));
              $("#results").append(
                $("<li>").append(
                  $("<meter>").attr("low", "0.33").attr("high", "0.66").attr("optimum", "1.0").attr("value", value.score),
                  $("<a>").attr("href", value.uri).append(value.label)
                )
              );
              labels.push(value.label);
            });
            var labellist = labels.join(". ");
            if(enablePostToVocabseditor)
              postToVocabseditor(fullText, uris, scores, current_language());
            responsiveVoice.speak(
              labellist,
              VOICE_PER_LANGUAGE[current_language()]
            );
            $.mobile.loading("hide");
          },
        });
        
        $("#previewtext").val(result);
        presentationTextResults = [];
      }

      function postToVocabseditor(text, uris, scores, lang){
        $.mobile.loading("show");
        $.ajax({
          url: "https://vocabseditor.buildvoc.co.uk/vocabs/concepts/import_from_annif_mobile/",
          method: "POST",
          data: JSON.stringify({
            text,
            uris,
            scores,
            lang,
          }),
          success(){
            $.mobile.loading("hide");
          }, 
          error(){
            $.mobile.loading("hide");
          }
        });
      }

      function getTopicsText() {
        var topicsText = "";
        var topicsList = $("#results");
        topicsList.find("a").each(function () {
          var currentTopic = this.innerText;
          topicsText += "#" + currentTopic.replace(/\s+/g, "-");
          topicsText += "\n";
        });
        return topicsText;
      }

      function copyToClipboard(textToBeCopied) {
        var $temp = $("<textarea>");
        $("body").append($temp);
        $temp.val(textToBeCopied).select();
        document.execCommand("copy");
        $temp.remove();
      }
    </script>

  </head>
  <body>
    <div class="container-fluid d-flex flex-column min-vh-100 justify-content-center align-items-center">
      <div class="fixed-top">
        <button type="button" class="btn btn-primary btn-sm float-end m-3" data-bs-toggle="modal" data-bs-target="#exampleModal">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-info-circle-fill" viewBox="0 0 16 16">
            <path d="M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16zm.93-9.412-1 4.705c-.07.34.029.533.304.533.194 0 .487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703 0-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381 2.29-.287zM8 5.5a1 1 0 1 1 0-2 1 1 0 0 1 0 2z"/>
          </svg>
        </button>
      </div>
      <div class="tab-content" id="pills-tabContent">
        <div class="tab-pane fade show active" id="image" role="tabpanel" aria-labelledby="image-tab" tabindex="0">
          <div class="row pt-4 ps-2 pe-2 pb-5 mb-5">
            <div class="col-12 mb-2">
              <div id="preview" class="rounded" style="background: black;">
                <img id="previewimg" class="img-fluid opacity-75" />
              </div>
            </div>
          </div>
          <div class="navbar fixed-bottom" style="padding-bottom: 112px;">
            <div class="container">
             <div class="row w-100 p-0 m-0">
              <div class="col-md-6">
               <div class="d-grid">
                 <label class="btn btn-secondary mb-3" for="imagefile">
                   <input
                     id="imagefile"
                     name="imagefile"
                     type="file"
                     accept="image/*"
                     capture="camera"
                     class="form-control d-none"
                     onchange="handleImage(this.files)"
                   />
                   <span class="d-block">
                     <svg xmlns="http://www.w3.org/2000/svg" width="1.5em" height="1.5em" fill="currentColor" class="bi bi-camera" viewBox="0 0 16 16">
                       <path d="M15 12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V6a1 1 0 0 1 1-1h1.172a3 3 0 0 0 2.12-.879l.83-.828A1 1 0 0 1 6.827 3h2.344a1 1 0 0 1 .707.293l.828.828A3 3 0 0 0 12.828 5H14a1 1 0 0 1 1 1v6zM2 4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2h-1.172a2 2 0 0 1-1.414-.586l-.828-.828A2 2 0 0 0 9.172 2H6.828a2 2 0 0 0-1.414.586l-.828.828A2 2 0 0 1 3.172 4H2z"/>
                       <path d="M8 11a2.5 2.5 0 1 1 0-5 2.5 2.5 0 0 1 0 5zm0 1a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7zM3 6.5a.5.5 0 1 1-1 0 .5.5 0 0 1 1 0z"/>
                     </svg>
                     Take a picture
                   </span>
                 </label>
               </div>
              </div>
              <div class="col-md-6">
               <div class="d-grid">
                 <!-- <label for="project" class="select">Language/Project:</label> -->
                 <select name="project" id="project" class="form-select" aria-label="Language/Project:" ></select>
               </div>
              </div>
             </div>
            </div>
          </div>
        </div>

        <div class="tab-pane fade" id="text" role="tabpanel" aria-labelledby="text-tab" tabindex="0">
          <div class="row pt-4 ps-2 pe-2 pb-5 mb-5">
            <div class="col-12 mb-2">
              <textarea id="previewtext" rows="20" cols="200" class="form-control form-control-lg bg-light p-2"> </textarea>
            </div>
          </div>
        </div>

        <div class="tab-pane fade" id="topics" role="tabpanel" aria-labelledby="topics-tab" tabindex="0">
          <div class="row pt-4 ps-2 pe-2 pb-5 mb-5">
            <div class="col-12 mb-2 ">
              <ul id="results" class="list-unstyled p-2 fs-4"></ul>
            </div>
          </div>
        </div>

        <div class="tab-pane fade" id="pills-clipboard" role="tabpanel" aria-labelledby="pills-clipboard-tab" tabindex="0">
          <div class="row p-2">
            <div class="col-12">
              Extracted text copied!
            </div>
          </div>
        </div>
      </div>



      <div class="navbar fixed-bottom " style="padding-bottom: 72px;">
        <div class="col-12 d-block d-sm-none">
          <div class="d-block float-end">
            <div style="width: 300px;vertical-align: top;font-family: Arial;font-size: 0.6em;line-height: normal;">
              <a rel="license" href="//responsivevoice.org/"><img title="ResponsiveVoice Text To Speech" src="https://responsivevoice.org/wp-content/uploads/2014/08/120x31.png" style="float: left; padding-right: 2px; height: 12px;" /></a>
              <span xmlns:dct="https://purl.org/dc/terms/" property="dct:title">
              <a href="//responsivevoice.org/" target="_blank" title="ResponsiveVoice Text To Speech" >ResponsiveVoice</a>
              </span>used under
              <a rel="license" href="https://creativecommons.org/licenses/by-nc-nd/4.0/" title="Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License">Non-Commercial License</a>
            </div>
          </div>
        </div>
        <!--Dekstop-->
        <div class="col-12 d-none d-sm-block">
          <div class="d-block float-end pb-4">
            <div style="width: 300px;vertical-align: top;font-family: Arial;font-size: 9pt;line-height: normal;">
              <a rel="license" href="//responsivevoice.org/"><img title="ResponsiveVoice Text To Speech" src="https://responsivevoice.org/wp-content/uploads/2014/08/120x31.png" style="float: left; padding-right: 2px;" /></a>
              <span xmlns:dct="https://purl.org/dc/terms/" property="dct:title">
              <a href="//responsivevoice.org/" target="_blank" title="ResponsiveVoice Text To Speech" >ResponsiveVoice</a>
              </span>used under
              <a rel="license" href="https://creativecommons.org/licenses/by-nc-nd/4.0/" title="Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License">Non-Commercial License</a>
            </div>
          </div>
        </div>
      </div>

     <nav class="navbar fixed-bottom bg-light border navbar-expand p-0 d-block d-sm-none">
      <ul class="nav nav-pills justify-content-center w-100 row" id="pills-tab" role="tablist">
        <div class="col-2">
          <li class="nav-item float-start capture-button" role="presentation">
            <button title="Capture an image" class="nav-link active" id="image-tab" data-bs-toggle="pill" data-bs-target="#image" type="button" role="tab" aria-controls="image" aria-selected="true">
              <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" class="bi bi-camera" viewBox="0 0 16 16">
                <path d="M15 12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V6a1 1 0 0 1 1-1h1.172a3 3 0 0 0 2.12-.879l.83-.828A1 1 0 0 1 6.827 3h2.344a1 1 0 0 1 .707.293l.828.828A3 3 0 0 0 12.828 5H14a1 1 0 0 1 1 1v6zM2 4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2h-1.172a2 2 0 0 1-1.414-.586l-.828-.828A2 2 0 0 0 9.172 2H6.828a2 2 0 0 0-1.414.586l-.828.828A2 2 0 0 1 3.172 4H2z"/>
                <path d="M8 11a2.5 2.5 0 1 1 0-5 2.5 2.5 0 0 1 0 5zm0 1a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7zM3 6.5a.5.5 0 1 1-1 0 .5.5 0 0 1 1 0z"/>
              </svg>
              <span class="small d-block" style="font-size: 0.6em;">Capture</span>
            </button>
          </li>
        </div>
        <div class="col-2">
          <li class="nav-item float-start text-button" role="presentation">
            <button title="Show extracted text" class="nav-link text-tab" id="text-tab" data-bs-toggle="pill" data-bs-target="#text" type="button" role="tab" aria-controls="text" aria-selected="true">
              <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" class="bi bi-upc-scan" viewBox="0 0 16 16">
                <path d="M1.5 1a.5.5 0 0 0-.5.5v3a.5.5 0 0 1-1 0v-3A1.5 1.5 0 0 1 1.5 0h3a.5.5 0 0 1 0 1h-3zM11 .5a.5.5 0 0 1 .5-.5h3A1.5 1.5 0 0 1 16 1.5v3a.5.5 0 0 1-1 0v-3a.5.5 0 0 0-.5-.5h-3a.5.5 0 0 1-.5-.5zM.5 11a.5.5 0 0 1 .5.5v3a.5.5 0 0 0 .5.5h3a.5.5 0 0 1 0 1h-3A1.5 1.5 0 0 1 0 14.5v-3a.5.5 0 0 1 .5-.5zm15 0a.5.5 0 0 1 .5.5v3a1.5 1.5 0 0 1-1.5 1.5h-3a.5.5 0 0 1 0-1h3a.5.5 0 0 0 .5-.5v-3a.5.5 0 0 1 .5-.5zM3 4.5a.5.5 0 0 1 1 0v7a.5.5 0 0 1-1 0v-7zm2 0a.5.5 0 0 1 1 0v7a.5.5 0 0 1-1 0v-7zm2 0a.5.5 0 0 1 1 0v7a.5.5 0 0 1-1 0v-7zm2 0a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-7zm3 0a.5.5 0 0 1 1 0v7a.5.5 0 0 1-1 0v-7z"/>
              </svg>
              <span class="small d-block"  style="font-size: 0.6em;">Text</span>
            </button>
          </li>
        </div>
        <div class="col-2">
          <li class="nav-item float-start topics-button" role="presentation">
            <button title="Show extracted topics" class="nav-link topics-tab" id="topics-tab" data-bs-toggle="pill" data-bs-target="#topics" type="button" role="tab" aria-controls="topics" aria-selected="false">
              <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" class="bi bi-tag" viewBox="0 0 16 16">
                <path d="M6 4.5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm-1 0a.5.5 0 1 0-1 0 .5.5 0 0 0 1 0z"/>
                <path d="M2 1h4.586a1 1 0 0 1 .707.293l7 7a1 1 0 0 1 0 1.414l-4.586 4.586a1 1 0 0 1-1.414 0l-7-7A1 1 0 0 1 1 6.586V2a1 1 0 0 1 1-1zm0 5.586 7 7L13.586 9l-7-7H2v4.586z"/>
              </svg>
              <span class="small d-block"  style="font-size: 0.6em;">Subjects</span>
            </button>
          </li>
        </div>
        <div class="col-2">
          <li class="nav-item float-start" title="Upload an image" role="presentation">
            <label class="btn nav-link" for="imagefile-upload">
              <input
                id="imagefile-upload"
                name="imagefile"
                type="file"
                accept="image/*"
                class="form-control d-none"
                onchange="handleImage(this.files)"
              />
              <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" class="bi bi-upload" viewBox="0 0 16 16">
                <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>
                <path d="M7.646 1.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1-.708.708L8.5 2.707V11.5a.5.5 0 0 1-1 0V2.707L5.354 4.854a.5.5 0 1 1-.708-.708l3-3z"/>
              </svg>
              <span class="small d-block"  style="font-size: 0.6em;">Upload</span>
            </label>
          </li>
        </div>
        <div class="col-2">
          <li class="nav-item float-start copy-button" role="presentation">
            <button title="Copy to clipboard" class="nav-link" id="pills-clipboard-tab" data-bs-toggle="pill" data-bs-target="#pills-clipboard" type="button" role="tab" aria-controls="pills-clipboard" aria-selected="false">
              <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16">
                <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/>
                <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/>
              </svg>
              <span class="small d-block"  style="font-size: 0.6em;">Copy</span>
            </button>
          </li>
        </div>
        <div class="col-2">
          <li class="nav-item float-start" title="Start a presentation" role="presentation">
            <label class="btn nav-link" for="imagefile-capture-multiple">
              <input
                id="imagefile-capture-multiple"
                name="imagefile"
                type="file"
                accept="image/*"
                capture="camera"
                class="form-control d-none"
              />
              <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" class="bi bi-bar-chart-line" viewBox="0 0 16 16">
                <path d="M11 2a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v12h.5a.5.5 0 0 1 0 1H.5a.5.5 0 0 1 0-1H1v-3a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v3h1V7a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v7h1V2zm1 12h2V2h-2v12zm-3 0V7H7v7h2zm-5 0v-3H2v3h2z"/>
              </svg>
              <span class="small d-block elipsis" style="font-size: 0.6em;">Presentation</span>
            </label>
          </li>
        </div>
      </ul>
     </nav>

     <!--Dekstop-->
     <nav class="navbar fixed-bottom bg-light border navbar-expand p-0 d-none d-sm-block">
      <ul class="nav nav-pills nav-justified w-100" id="pills-tab" role="tablist">

          <li class="nav-item capture-button" role="presentation">
            <button title="Capture an image" class="nav-link active" id="image-tab" data-bs-toggle="pill" data-bs-target="#image" type="button" role="tab" aria-controls="image" aria-selected="true">
              <svg xmlns="http://www.w3.org/2000/svg" width="1.5em" height="1.5em" fill="currentColor" class="bi bi-camera" viewBox="0 0 16 16">
                <path d="M15 12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V6a1 1 0 0 1 1-1h1.172a3 3 0 0 0 2.12-.879l.83-.828A1 1 0 0 1 6.827 3h2.344a1 1 0 0 1 .707.293l.828.828A3 3 0 0 0 12.828 5H14a1 1 0 0 1 1 1v6zM2 4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2h-1.172a2 2 0 0 1-1.414-.586l-.828-.828A2 2 0 0 0 9.172 2H6.828a2 2 0 0 0-1.414.586l-.828.828A2 2 0 0 1 3.172 4H2z"/>
                <path d="M8 11a2.5 2.5 0 1 1 0-5 2.5 2.5 0 0 1 0 5zm0 1a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7zM3 6.5a.5.5 0 1 1-1 0 .5.5 0 0 1 1 0z"/>
              </svg>
              <span class="d-block" >Take a picture</span>
            </button>
          </li>

          <li class="nav-item  text-button" role="presentation">
            <button title="Show extracted text" class="nav-link text-tab" id="text-tab" data-bs-toggle="pill" data-bs-target="#text" type="button" role="tab" aria-controls="text" aria-selected="true">
              <svg xmlns="http://www.w3.org/2000/svg" width="1.5em" height="1.5em" fill="currentColor" class="bi bi-upc-scan" viewBox="0 0 16 16">
                <path d="M1.5 1a.5.5 0 0 0-.5.5v3a.5.5 0 0 1-1 0v-3A1.5 1.5 0 0 1 1.5 0h3a.5.5 0 0 1 0 1h-3zM11 .5a.5.5 0 0 1 .5-.5h3A1.5 1.5 0 0 1 16 1.5v3a.5.5 0 0 1-1 0v-3a.5.5 0 0 0-.5-.5h-3a.5.5 0 0 1-.5-.5zM.5 11a.5.5 0 0 1 .5.5v3a.5.5 0 0 0 .5.5h3a.5.5 0 0 1 0 1h-3A1.5 1.5 0 0 1 0 14.5v-3a.5.5 0 0 1 .5-.5zm15 0a.5.5 0 0 1 .5.5v3a1.5 1.5 0 0 1-1.5 1.5h-3a.5.5 0 0 1 0-1h3a.5.5 0 0 0 .5-.5v-3a.5.5 0 0 1 .5-.5zM3 4.5a.5.5 0 0 1 1 0v7a.5.5 0 0 1-1 0v-7zm2 0a.5.5 0 0 1 1 0v7a.5.5 0 0 1-1 0v-7zm2 0a.5.5 0 0 1 1 0v7a.5.5 0 0 1-1 0v-7zm2 0a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-7zm3 0a.5.5 0 0 1 1 0v7a.5.5 0 0 1-1 0v-7z"/>
              </svg>
              <span class="d-block"  >Extracted Text</span>
            </button>
          </li>

          <li class="nav-item  topics-button" role="presentation">
            <button title="Show extracted topics" class="nav-link topics-tab" id="topics-tab" data-bs-toggle="pill" data-bs-target="#topics" type="button" role="tab" aria-controls="topics" aria-selected="false">
              <svg xmlns="http://www.w3.org/2000/svg" width="1.5em" height="1.5em" fill="currentColor" class="bi bi-tag" viewBox="0 0 16 16">
                <path d="M6 4.5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm-1 0a.5.5 0 1 0-1 0 .5.5 0 0 0 1 0z"/>
                <path d="M2 1h4.586a1 1 0 0 1 .707.293l7 7a1 1 0 0 1 0 1.414l-4.586 4.586a1 1 0 0 1-1.414 0l-7-7A1 1 0 0 1 1 6.586V2a1 1 0 0 1 1-1zm0 5.586 7 7L13.586 9l-7-7H2v4.586z"/>
              </svg>
              <span class="d-block"  >Suggested Subjects</span>
            </button>
          </li>

          <li class="nav-item  upload-buttonnn" title="Upload an image" role="presentation">
            <label class="btn nav-link" for="imagefile-upload">
              <input
                id="imagefile-upload"
                name="imagefile"
                type="file"
                accept="image/*"
                class="form-control d-none"
              />
              <svg xmlns="http://www.w3.org/2000/svg" width="1.5em" height="1.5em" fill="currentColor" class="bi bi-upload" viewBox="0 0 16 16">
                <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>
                <path d="M7.646 1.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1-.708.708L8.5 2.707V11.5a.5.5 0 0 1-1 0V2.707L5.354 4.854a.5.5 0 1 1-.708-.708l3-3z"/>
              </svg>
              <span class="d-block"  >Upload</span>
            </label>
          </li>

          <li class="nav-item  copy-button" role="presentation">
            <button title="Copy to clipboard" class="nav-link" id="pills-clipboard-tab" data-bs-toggle="pill" data-bs-target="#pills-clipboard" type="button" role="tab" aria-controls="pills-clipboard" aria-selected="false">
              <svg xmlns="http://www.w3.org/2000/svg" width="1.5em" height="1.5em" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16">
                <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/>
                <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/>
              </svg>
              <span class="d-block"  >Copy to clipboard</span>
            </button>
          </li>

          <li class="nav-item  capture-presentation-buttonnn" title="Start a presentation" role="presentation">
            <label class="btn nav-link" for="imagefile-capture-multiple">
              <input
                id="imagefile-capture-multiple"
                name="imagefile"
                type="file"
                accept="image/*"
                capture="camera"
                class="form-control d-none"
              />
              <svg xmlns="http://www.w3.org/2000/svg" width="1.5em" height="1.5em" fill="currentColor" class="bi bi-bar-chart-line" viewBox="0 0 16 16">
                <path d="M11 2a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v12h.5a.5.5 0 0 1 0 1H.5a.5.5 0 0 1 0-1H1v-3a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v3h1V7a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v7h1V2zm1 12h2V2h-2v12zm-3 0V7H7v7h2zm-5 0v-3H2v3h2z"/>
              </svg>
              <span class="d-block" >Presentation</span>
            </label>
          </li>

      </ul>
     </nav>

    </div>

    <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-xl modal-dialog-centered modal-dialog-scrollable">
        <div class="modal-content">
          <div class="modal-header">
            <h2 class="modal-title" id="exampleModalLabel">Test a prototype for Fire Safety Analytics</h2>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <div class="information-box">
              <p>This app was made available to you free of charge  by Phil Stacey with the support from <b><a style="text-decoration: none" href="https://www.digitalocean.com/"> DigitalOcean.</a></b></p>
              <p>The purpose of the app is to showcase Text Analytics in Fire Safety to newcomers.</p>
              <p>
                <svg xmlns="http://www.w3.org/2000/svg" width="1.5em" height="1.5em" fill="currentColor" class="bi bi-camera" viewBox="0 0 16 16">
                  <path d="M15 12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V6a1 1 0 0 1 1-1h1.172a3 3 0 0 0 2.12-.879l.83-.828A1 1 0 0 1 6.827 3h2.344a1 1 0 0 1 .707.293l.828.828A3 3 0 0 0 12.828 5H14a1 1 0 0 1 1 1v6zM2 4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2h-1.172a2 2 0 0 1-1.414-.586l-.828-.828A2 2 0 0 0 9.172 2H6.828a2 2 0 0 0-1.414.586l-.828.828A2 2 0 0 1 3.172 4H2z"/>
                  <path d="M8 11a2.5 2.5 0 1 1 0-5 2.5 2.5 0 0 1 0 5zm0 1a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7zM3 6.5a.5.5 0 1 1-1 0 .5.5 0 0 1 1 0z"/>
                </svg>
                 <b>a)</b> Take a picture of a fire safety document using your mobile phone Then the app will automatically:</p>
              <ul class="icons-information-list" style="list-style-type:none; padding: 0">
                <li>
                  <svg xmlns="http://www.w3.org/2000/svg" width="1.5em" height="1.5em" fill="currentColor" class="bi bi-upc-scan" viewBox="0 0 16 16">
                    <path d="M1.5 1a.5.5 0 0 0-.5.5v3a.5.5 0 0 1-1 0v-3A1.5 1.5 0 0 1 1.5 0h3a.5.5 0 0 1 0 1h-3zM11 .5a.5.5 0 0 1 .5-.5h3A1.5 1.5 0 0 1 16 1.5v3a.5.5 0 0 1-1 0v-3a.5.5 0 0 0-.5-.5h-3a.5.5 0 0 1-.5-.5zM.5 11a.5.5 0 0 1 .5.5v3a.5.5 0 0 0 .5.5h3a.5.5 0 0 1 0 1h-3A1.5 1.5 0 0 1 0 14.5v-3a.5.5 0 0 1 .5-.5zm15 0a.5.5 0 0 1 .5.5v3a1.5 1.5 0 0 1-1.5 1.5h-3a.5.5 0 0 1 0-1h3a.5.5 0 0 0 .5-.5v-3a.5.5 0 0 1 .5-.5zM3 4.5a.5.5 0 0 1 1 0v7a.5.5 0 0 1-1 0v-7zm2 0a.5.5 0 0 1 1 0v7a.5.5 0 0 1-1 0v-7zm2 0a.5.5 0 0 1 1 0v7a.5.5 0 0 1-1 0v-7zm2 0a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-7zm3 0a.5.5 0 0 1 1 0v7a.5.5 0 0 1-1 0v-7z"/>
                  </svg>
                  Convert it to text using Optical Character Recognition (OCR) technology with <b><a style="text-decoration: none" href="https://en.wikipedia.org/wiki/Tesseract_(software)">Tesseract</a></b>
                </li>
                <li style="margin: 1rem 0;">
                  <svg xmlns="http://www.w3.org/2000/svg" width="1.5em" height="1.5em" fill="currentColor" class="bi bi-tag" viewBox="0 0 16 16">
                    <path d="M6 4.5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm-1 0a.5.5 0 1 0-1 0 .5.5 0 0 0 1 0z"/>
                    <path d="M2 1h4.586a1 1 0 0 1 .707.293l7 7a1 1 0 0 1 0 1.414l-4.586 4.586a1 1 0 0 1-1.414 0l-7-7A1 1 0 0 1 1 6.586V2a1 1 0 0 1 1-1zm0 5.586 7 7L13.586 9l-7-7H2v4.586z"/>
                  </svg>
                   b) Analyse the text using <b><a style="text-decoration: none" href="https://annif.org/">Annif</a></b> (Tool for automated subject indexing and classification)
                </li>
                <li style="margin: 1rem 0;">
                   c) Set of suggested topics with links to <b><a style="text-decoration: none" href="https://data-dictionary.buildvoc.co.uk/buildvoc/en/">Buildvoc's data dictionary. </b></a>
                </li>
                <li style="margin: 1rem 0;">
                  <svg xmlns="http://www.w3.org/2000/svg" width="1.5em" height="1.5em" fill="currentColor" class="bi bi-upload" viewBox="0 0 16 16">
                    <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>
                    <path d="M7.646 1.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1-.708.708L8.5 2.707V11.5a.5.5 0 0 1-1 0V2.707L5.354 4.854a.5.5 0 1 1-.708-.708l3-3z"/>
                  </svg>
                  Upload a screenshot
                </li>
                <li style="margin: 1rem 0;">
                  <svg xmlns="http://www.w3.org/2000/svg" width="1.5em" height="1.5em" fill="currentColor" class="bi bi-bar-chart-line" viewBox="0 0 16 16">
                    <path d="M11 2a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v12h.5a.5.5 0 0 1 0 1H.5a.5.5 0 0 1 0-1H1v-3a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v3h1V7a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v7h1V2zm1 12h2V2h-2v12zm-3 0V7H7v7h2zm-5 0v-3H2v3h2z"/>
                  </svg>
                  Take a picture of the first presentation slide, then second slide next press 
                  <svg xmlns="http://www.w3.org/2000/svg" width="1.5em" height="1.5em" fill="currentColor" class="bi bi-upc-scan" viewBox="0 0 16 16">
                    <path d="M1.5 1a.5.5 0 0 0-.5.5v3a.5.5 0 0 1-1 0v-3A1.5 1.5 0 0 1 1.5 0h3a.5.5 0 0 1 0 1h-3zM11 .5a.5.5 0 0 1 .5-.5h3A1.5 1.5 0 0 1 16 1.5v3a.5.5 0 0 1-1 0v-3a.5.5 0 0 0-.5-.5h-3a.5.5 0 0 1-.5-.5zM.5 11a.5.5 0 0 1 .5.5v3a.5.5 0 0 0 .5.5h3a.5.5 0 0 1 0 1h-3A1.5 1.5 0 0 1 0 14.5v-3a.5.5 0 0 1 .5-.5zm15 0a.5.5 0 0 1 .5.5v3a1.5 1.5 0 0 1-1.5 1.5h-3a.5.5 0 0 1 0-1h3a.5.5 0 0 0 .5-.5v-3a.5.5 0 0 1 .5-.5zM3 4.5a.5.5 0 0 1 1 0v7a.5.5 0 0 1-1 0v-7zm2 0a.5.5 0 0 1 1 0v7a.5.5 0 0 1-1 0v-7zm2 0a.5.5 0 0 1 1 0v7a.5.5 0 0 1-1 0v-7zm2 0a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-7zm3 0a.5.5 0 0 1 1 0v7a.5.5 0 0 1-1 0v-7z"/>
                  </svg>
                  See captured text
                  <svg xmlns="http://www.w3.org/2000/svg" width="1.5em" height="1.5em" fill="currentColor" class="bi bi-tag" viewBox="0 0 16 16">
                    <path d="M6 4.5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm-1 0a.5.5 0 1 0-1 0 .5.5 0 0 0 1 0z"/>
                    <path d="M2 1h4.586a1 1 0 0 1 .707.293l7 7a1 1 0 0 1 0 1.414l-4.586 4.586a1 1 0 0 1-1.414 0l-7-7A1 1 0 0 1 1 6.586V2a1 1 0 0 1 1-1zm0 5.586 7 7L13.586 9l-7-7H2v4.586z"/>
                  </svg>
                  to see suggested subjects
                </li>
                <li style="margin: 1rem 0;">
                  <svg xmlns="http://www.w3.org/2000/svg" width="1.5em" height="1.5em" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16">
                    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/>
                    <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/>
                  </svg>
                  Copy text and suggested subjects to notes
                </li>
                <li style="margin: 1rem 0;">
                  which uses <b><a style="text-decoration: none" href="https://skosmos.org/">Skosmos</a></b>
                </li>
              </ul>
              <div class="enable-post-to-vocabseditor" title="Enable posting to vocabseditor.">
                <button></button>
              </div>
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
          </div>
        </div>
      </div>
    </div>

  </body>
</html>
